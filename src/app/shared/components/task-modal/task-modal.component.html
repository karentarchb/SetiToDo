<ion-header>
  <ion-toolbar>
    <ion-title>{{ isEditMode ? 'Editar Tarea' : 'Nueva Tarea' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cancel()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="modal-content">
    <form [formGroup]="taskForm">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Descripción</mat-label>
        <textarea
          matInput
          formControlName="description"
          rows="2"
          placeholder="¿Qué necesitas hacer?"></textarea>
        <mat-error *ngIf="taskForm.get('description')?.hasError('required')">
          La descripción es requerida
        </mat-error>
      </mat-form-field>

      <div class="time-row">
        <mat-form-field appearance="outline" class="time-field">
          <mat-label>Hora inicio</mat-label>
          <input matInput [ngxTimepicker]="pickerStart" formControlName="startTime" readonly>
          <ngx-material-timepicker-toggle matIconSuffix [for]="pickerStart"></ngx-material-timepicker-toggle>
          <ngx-material-timepicker #pickerStart></ngx-material-timepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" class="time-field">
          <mat-label>Hora fin</mat-label>
          <input matInput [ngxTimepicker]="pickerEnd" formControlName="endTime" readonly>
          <ngx-material-timepicker-toggle matIconSuffix [for]="pickerEnd"></ngx-material-timepicker-toggle>
          <ngx-material-timepicker #pickerEnd></ngx-material-timepicker>
        </mat-form-field>
      </div>

      <div class="repeat-section">
        <label class="section-label">¿Se repite?</label>
        <div class="days-selector">
          <ion-chip
            *ngFor="let day of weekDays"
            [outline]="!day.selected"
            [color]="day.selected ? 'primary' : 'medium'"
            (click)="toggleDay(day)">
            {{ day.label }}
          </ion-chip>
        </div>
      </div>
    </form>
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="footer-buttons">
      <button mat-raised-button (click)="cancel()">
        Cancelar
      </button>
      <button
        mat-raised-button
        (click)="save()"
        [disabled]="!taskForm.valid">
        {{ isEditMode ? 'Actualizar' : 'Guardar' }}
      </button>
    </div>
  </ion-toolbar>
</ion-footer>
