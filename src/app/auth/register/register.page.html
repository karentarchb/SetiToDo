<app-auth-layout title="Crear Cuenta" subtitle="Regístrate en SetiToDo">
  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div class="name-grid">
      <mat-form-field appearance="outline">
        <mat-label>Nombre</mat-label>
        <input
          matInput
          type="text"
          formControlName="firstName"
          placeholder="Juan">
        <mat-icon matPrefix>person</mat-icon>
        <mat-error *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
          {{ getFirstNameErrorMessage() }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Apellido</mat-label>
        <input
          matInput
          type="text"
          formControlName="lastName"
          placeholder="Pérez">
        <mat-icon matPrefix>person_outline</mat-icon>
        <mat-error *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
          {{ getLastNameErrorMessage() }}
        </mat-error>
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline">
      <mat-label>Correo Electrónico</mat-label>
      <input
        matInput
        type="email"
        formControlName="email"
        placeholder="ejemplo@correo.com">
      <mat-icon matPrefix>email</mat-icon>
      <mat-error *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
        {{ getEmailErrorMessage() }}
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="password-field">
      <mat-label>Contraseña</mat-label>
      <input
        matInput
        [type]="hidePassword ? 'password' : 'text'"
        formControlName="password"
        placeholder="Mínimo 6 caracteres">
      <mat-icon matPrefix>lock</mat-icon>
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="hidePassword = !hidePassword"
        class="eye-icon">
        <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
        {{ getPasswordErrorMessage() }}
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="password-field">
      <mat-label>Confirmar Contraseña</mat-label>
      <input
        matInput
        [type]="hideConfirmPassword ? 'password' : 'text'"
        formControlName="confirmPassword"
        placeholder="Confirma tu contraseña">
      <mat-icon matPrefix>lock_outline</mat-icon>
      <button
        mat-icon-button
        matSuffix
        type="button"
        (click)="hideConfirmPassword = !hideConfirmPassword"
        class="eye-icon">
        <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-icon
        *ngIf="isPasswordMatch() && registerForm.get('confirmPassword')?.touched"
        matSuffix
        class="success-icon"
        style="margin-right: 8px;">
        check_circle
      </mat-icon>
      <mat-error *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
        {{ getConfirmPasswordErrorMessage() }}
      </mat-error>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="isLoading">
      <mat-spinner *ngIf="isLoading" diameter="20" style="display: inline-block; margin-right: 8px;"></mat-spinner>
      {{ isLoading ? 'Registrando...' : 'Registrarse' }}
    </button>

    <div style="text-align: center; margin-top: 1.5rem;">
      <button
        mat-button
        color="accent"
        type="button"
        (click)="navigateToLogin()">
        ¿Ya tienes cuenta? Inicia sesión
      </button>
    </div>
  </form>
</app-auth-layout>
